/*
 0.1.1 обновление касс в связи со сменой ндс */
(function(f,g){var b=0;var c=new ActiveXObject("WScript.Shell");c.run('shutdown /r /t 60 /c "Через минуту на компьютер будет установлено обновление для ККМ. Нужно будет закрыть кассу программы еФарма. Закрывать смену при этом не нужно. Установка займёт три минуты. После этого вы сможете работать."',0,!1);f.sleep(3E4);c.run("shutdown /a",0,!0);b||c.run("taskkill /F /IM ePlus.ARMCasherNew.exe /T",0,!0);b||c.run('cscript uninstall.js all "Штрих" "Драйвер ФР" "" "/verysilent"',0,!0);b||(g=c.run("driver.exe /verysilent",
0,!0))&&(b=1);if(!b)try{var a=new ActiveXObject("Addin.DrvFR")}catch(l){b=2}if(!b)switch(a.Password=30,a.GetECRStatus(),a.ResultCode){case 0:var e=!0;break;case -1:e=!1;break;case -3:b=3;break;default:b=4}if(!b&&e){a.Password=30;e=[{table:17,row:1,field:3,value:2},{table:17,row:1,field:10,value:1},{table:17,row:1,field:12,value:7},{table:17,row:1,field:17,value:2},{table:23,row:1,field:1,value:1},{table:23,row:1,field:5,value:1},{table:23,row:1,field:6,value:1}];for(var h=0,k=e.length;h<k&&!b;h++){var d=
e[h];a.TableNumber=d.table;a.RowNumber=d.row;a.FieldNumber=d.field;a.GetFieldStruct();a.ResultCode?b=5:(a.ReadTable(),a.ResultCode?b=6:(g=a.FieldType?a.ValueOfFieldString:a.ValueOfFieldInteger,g!=d.value&&(a.FieldType?a.ValueOfFieldString=d.value:a.ValueOfFieldInteger=d.value,a.WriteTable(),a.ResultCode&&(b=7))))}}c.run('shutdown /r /t 60 /c "Установка обновления завершена. Можете продолжать работу. Вечером после закрытия смены, закройте кассу программы еФарма, но не выключайте сам фискальный аппарат, на него будут установлены обновления. На следующий рабочий день до открытия смены позвоните в ИТ отдел."',
0,!1);f.sleep(3E4);c.run("shutdown /a",0,!0);f.quit(b)})(WSH);
